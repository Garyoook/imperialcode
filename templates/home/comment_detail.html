<!DOCTYPE html>
<html>
  {% load static %}
  <head>
    <title>Single Post Page</title>
    <link rel="icon" href="{% static 'resources/favicon.ico' %}" type="image/x-icon">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link href={% static "resources/css/axure_rp_page.css" %} type="text/css" rel="stylesheet"/>
    <link href={% static "data/styles.css" %} type="text/css" rel="stylesheet"/>
    <link href='{% static "files/post_detail/styles.css" %}?{% now "U" %}' type="text/css" rel="stylesheet"/>
    <script src={% static "resources/scripts/jquery-3.2.1.min.js" %}></script>
    <script src={% static "resources/scripts/axure/axQuery.js" %}></script>
    <script src={% static "resources/scripts/axure/globals.js" %}></script>
    <script src={% static "resources/scripts/axutils.js" %}></script>
    <script src={% static "resources/scripts/axure/annotation.js" %}></script>
    <script src={% static "resources/scripts/axure/axQuery.std.js" %}></script>
    <script src={% static "resources/scripts/axure/doc.js" %}></script>
    <script src={% static "resources/scripts/messagecenter.js" %}></script>
    <script src={% static "resources/scripts/axure/events.js" %}></script>
    <script src={% static "resources/scripts/axure/recording.js" %}></script>
    <script src={% static "resources/scripts/axure/action.js" %}></script>
    <script src={% static "resources/scripts/axure/expr.js" %}></script>
    <script src={% static "resources/scripts/axure/geometry.js" %}></script>
    <script src={% static "resources/scripts/axure/flyout.js" %}></script>
    <script src={% static "resources/scripts/axure/model.js" %}></script>
    <script src={% static "resources/scripts/axure/repeater.js" %}></script>
    <script src={% static "resources/scripts/axure/sto.js" %}></script>
    <script src={% static "resources/scripts/axure/utils.temp.js" %}></script>
    <script src={% static "resources/scripts/axure/variables.js" %}></script>
    <script src={% static "resources/scripts/axure/drag.js" %}></script>
    <script src={% static "resources/scripts/axure/move.js" %}></script>
    <script src={% static "resources/scripts/axure/visibility.js" %}></script>
    <script src={% static "resources/scripts/axure/style.js" %}></script>
    <script src={% static "resources/scripts/axure/adaptive.js" %}></script>
    <script src={% static "resources/scripts/axure/tree.js" %}></script>
    <!-- <script src={% static "resources/scripts/axure/init.temp.js" %}></script> -->
    <script src={% static "resources/scripts/axure/legacy.js" %}></script>
    <script src={% static "resources/scripts/axure/viewer.js" %}></script>
    <script src={% static "resources/scripts/axure/math.js" %}></script>
    <script src={% static "resources/scripts/axure/jquery.nicescroll.min.js" %}></script>
    <script src={% static "data/document.js" %}></script>
    <script src={% static "files/post_detail/data.js" %}></script>
    <script type="text/javascript">
      $axure.utils.getTransparentGifPath = function() { return "{% static 'resources/images/transparent.gif' %}"; };
      $axure.utils.getOtherPath = function() { return "{% static 'resources/Other.html' %}"; };
      $axure.utils.getReloadPath = function() { return "{% static 'resources/reload.html' %}"; };
    </script>
  </head>
  <body>
  {% load humanize %}
    <div id="base" class="">

      {% include "home/../global_components/navbar.html" %}
      <div id="u553" style="display:none; visibility:hidden;"></div>

      <!-- Unnamed (Rectangle) -->
      <div id="u570" class="ax_default button" onclick="window.location.href='{{prev_page}}'">
        <div id="u570_div" class=""></div>
        <div id="u570_text" class="text ">
          <p><span>‚Æú Back</span></p>
        </div>
      </div>

      <!-- Post Title -->
      <div id="u571" class="ax_default heading_1">
        <div id="u571_div" class=""></div>
        <div id="u571_text" class="text ">
          <p><span>{{ post.title }}</span></p>
        </div>
      </div>

      <!-- Post editor -->
      <div id="u572" class="ax_default heading_1">
        <div id="u572_div" class=""></div>
        <div id="u572_text" class="text ">
          <p><span>Post by: {{ post.user }}</span></p>
        </div>
      </div>

      <!-- Post created_at -->
      <div id="u573" class="ax_default heading_1">
        <div id="u573_div" class=""></div>
        <div id="u573_text" class="text ">
          <p><span>Created at: {{post.created_at}}</span></p>
        </div>
      </div>

      <!--views counter -->
      <div id="u574" class="ax_default heading_1">
        <div id="u574_div" class=""></div>
        <div id="u574_text" class="text ">
          <p><span>üëÅ {{ post.views }}</span></p>
        </div>
      </div>
          <!-- comments counter -->
      <div id="u584" class="ax_default heading_1">
        <div id="u584_div" class=""></div>
        <div id="u584_text" class="text ">
          <p><span>üó® {{post.views}}</span></p>
        </div>
      </div>

      <!-- a line -->
      <div id="u575" class="ax_default line">
        <img id="u575_img" class="img " src={% static "images/single_post_page/u575.svg" %}/>
        <div id="u575_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u576" class="ax_default button">
        <div id="u576_div" class=""></div>
        <div id="u576_text" class="text ">
          <p><span>‚ØÖ</span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u577" class="ax_default button">
        <div id="u577_div" class=""></div>
        <div id="u577_text" class="text ">
          <p><span>‚ØÜ</span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u578" class="ax_default heading_1">
        <div id="u578_div" class=""></div>
        <div id="u578_text" class="text ">
          <p><span>{{post.upvotes}}</span></p>
        </div>
      </div>


      <!-- post content:(desc) -->
      <div id="u579" class="ax_default paragraph">
        <div id="u579_div" class=""></div>
        <div id="u579_text" class="text ">
            <p id="post_content">{{post.desc}}</p>
        </div>
      </div>

      {% if request.user == post.user %}
        <!--  only can edit when the browsing user is the one who created the post  -->
        <a href="{% url 'forum-edit' post.id %}">
          <div id="u639" class="ax_default label">
            <div id="u639_div" class=""></div>
            <div id="u639_text" class="text ">
              <p><span>‚úíÔ∏è Edit</span></p>
            </div>
          </div>
        </a>
        <form method="post" action="{% url 'forum-delete' post.id %}">
          {% csrf_token %}
          <!-- Unnamed (Rectangle) -->
          <div id="u640" class="ax_default label">
            <div id="u640_text" class="text "></div>
            <input type="submit" id="u640_div" class="" value="üóë Delete">
          </div>
        </form>
      {% endif  %}

      <!-- a line -->
      <div id="u580" class="ax_default line">
        <img id="u580_img" class="img " src={% static "images/single_post_page/u575.svg" %}/>
        <div id="u580_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u581" class="ax_default box_1">
        <div id="u581_div" class=""></div>

          <!-- comment text area -->
          <div id="u582" class="ax_default text_area">
            <form id="u582_input" class="u582_input" method="post" action="{% url 'add-comment' post.id %}">
                {% csrf_token %}
                <div id="u618" class="ax_default text_area">
                    <div id="u618_div" class=""></div>
                    <textarea name="comment_content" id="u618_input" class="u618_input" placeholder="Enter your comment"></textarea>
                </div>
                <div id="u619" class="ax_default button">
                    <img id="u619_img" class="img " src={% static "images/single_post_page/u619.svg" %}/>
                    <div id="u619_text" class="text ">
                        <p><span>‚úâ Post</span></p>
                    </div>
              </div>
            </form>
          </div>

        </div>
      </div>


      {% for comment in post.comment_set.all %}
        <!-- Unnamed (Group) -->
      <div id="u585" class="ax_default" data-left="203" data-top="785" data-width="670" data-height="103">

        <!-- Unnamed (Rectangle) -->
        <div id="u586" class="ax_default box_2">
          <div id="u586_div" class=""></div>
          <div id="u586_text" class="text " style="display:none; visibility: hidden">
            <p></p>
          </div>
        </div>

        <div id="u587" class="ax_default heading_1">
          <div id="u587_div" class=""></div>
          <div id="u587_text" class="text ">
            <p><span>{{comment.user}}</span></p>
          </div>
        </div>
        <!-- comment content -->
        <div id="u588" class="ax_default paragraph">
          <div id="u588_div" class=""></div>
          <div id="u588_text" class="text ">
            <p><span>{{comment.desc}}</span> -
              <span><i>{{comment.created_at | naturaltime}}</i>
               {% if request.user == comment.user %}
                <a href="{% url 'edit-comment' comment.id %}">Edit this comment</a>
                <form method="post" action="{% url 'delete-comment' comment.id %}">
                {% csrf_token %}
<!--                <a href="{% url 'delete-comment' comment.id %}">Delete</a>-->
                <input type="submit" name="Delete", value="Delete">
                </form>
                {% endif %}
              </span></p>
          </div>
        </div>
  {% endfor %}
    </div>
    <script>
        const INITIAL_TOP_POS = 165;
        const PADDING = 55;
        const MIN_TOP_POS = 275;
        let postTextHeight = document.getElementById("post_content").getBoundingClientRect().height
        let bottomSeparator = document.getElementById("u580");
        let commentPanel = document.getElementById("u581");

        bottomSeparator.style.top = Math.max(INITIAL_TOP_POS + postTextHeight + PADDING, MIN_TOP_POS)  + "px";
        commentPanel.style.top = bottomSeparator.offsetTop + PADDING - 30 + "px";
    </script>
    <script src={% static "resources/scripts/axure/ios.js" %}></script>
  </div>
  </body>
</html>
